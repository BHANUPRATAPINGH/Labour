<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LabourConnect - Find Workers in India</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
    
    <!-- Leaflet CSS for Map -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css">
    
    <!-- Firebase SDKs (ES Modules) -->
    <script type="module">
        // Import Firebase modules
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAuth, signInWithPhoneNumber, RecaptchaVerifier } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
        import { getFirestore, collection, addDoc, getDocs, query, where, updateDoc, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";
        import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-storage.js";
        
        // Your Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyB4b47hPA2wGYWUIhkajcnWSUb8w_gQduU",
            authDomain: "labourhiringindia.firebaseapp.com",
            projectId: "labourhiringindia",
            storageBucket: "labourhiringindia.firebasestorage.app",
            messagingSenderId: "1057256057838",
            appId: "1:1057256057838:web:7a3b1a9e7a820a22dd3cff"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const storage = getStorage(app);
        
        // Make available globally
        window.firebaseApp = app;
        window.firebaseAuth = auth;
        window.firebaseDb = db;
        window.firebaseStorage = storage;
        window.firebaseModules = {
            signInWithPhoneNumber,
            RecaptchaVerifier,
            collection,
            addDoc,
            getDocs,
            query,
            where,
            updateDoc,
            doc,
            setDoc,
            ref,
            uploadBytes,
            getDownloadURL
        };
        
        console.log("Firebase initialized successfully!");
    </script>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm sticky-top">
        <div class="container">
            <a class="navbar-brand fw-bold text-primary" href="#" onclick="app.loadPage('home')">
                <i class="bi bi-hammer"></i> LabourConnect
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto" id="mainNav">
                    <!-- Navigation will be loaded by JavaScript -->
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content Area -->
    <main class="py-3">
        <div class="container" id="app">
            <div class="initial-loader" id="initialLoader">
                <div class="spinner-border text-primary mb-3"></div>
                <h4>Initializing LabourConnect...</h4>
                <p class="text-muted">Connecting to Firebase database</p>
                <div id="firebaseStatus" class="mt-3">
                    <small class="text-muted">Loading Firebase modules...</small>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-dark text-white py-4 mt-4">
        <div class="container">
            <div class="row">
                <div class="col-md-4 mb-3">
                    <h5><i class="bi bi-hammer"></i> LabourConnect</h5>
                    <p class="mb-0">Empowering workers, simplifying hiring.</p>
                </div>
                <div class="col-md-4 mb-3">
                    <h5>Quick Links</h5>
                    <ul class="list-unstyled">
                        <li><a href="#" class="text-white-50" onclick="app.loadPage('home')">Home</a></li>
                        <li><a href="#" class="text-white-50" onclick="app.loadPage('find-workers')">Find Workers</a></li>
                        <li><a href="#" class="text-white-50" onclick="app.loadPage('registration')">Register</a></li>
                    </ul>
                </div>
                <div class="col-md-4 mb-3">
                    <h5>Need Help?</h5>
                    <p class="mb-1"><i class="bi bi-telephone"></i> 1800-123-4567</p>
                    <p class="mb-1"><i class="bi bi-envelope"></i> help@labourconnect.in</p>
                    <p class="mb-0"><i class="bi bi-clock"></i> 24x7 Support</p>
                </div>
            </div>
            <hr class="bg-light my-3">
            <div class="row">
                <div class="col-md-6">
                    <p class="mb-0">&copy; 2024 LabourConnect. All rights reserved.</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <a href="#" class="text-white-50 me-3" onclick="app.loadPage('privacy')">Privacy</a>
                    <a href="#" class="text-white-50 me-3" onclick="app.loadPage('terms')">Terms</a>
                    <a href="#" class="text-white-50" onclick="app.loadPage('contact')">Contact</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- JavaScript Files -->
    <!-- Leaflet JS for Map -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Our JavaScript Files -->
    <script src="js/firebase-services.js"></script>
    <script src="js/script.js"></script>
    
    <!-- Initialize App after Firebase loads -->
    <script>
        // Wait for Firebase to initialize
        let firebaseCheckInterval = setInterval(() => {
            if (window.firebaseDb && window.firebaseAuth) {
                clearInterval(firebaseCheckInterval);
                document.getElementById('firebaseStatus').innerHTML = 
                    '<span class="text-success">✓ Firebase connected successfully</span>';
                
                // Initialize app after Firebase is ready
                setTimeout(() => {
                    document.addEventListener('DOMContentLoaded', function() {
                        console.log('Starting LabourConnect App...');
                        window.app = new LabourHiringApp();
                    });
                    
                    // If DOM already loaded
                    if (document.readyState === 'complete' || document.readyState === 'interactive') {
                        console.log('DOM ready, starting app...');
                        window.app = new LabourHiringApp();
                    }
                }, 500);
            }
        }, 100);
        
        // Timeout after 10 seconds
        setTimeout(() => {
            if (!window.firebaseDb) {
                document.getElementById('firebaseStatus').innerHTML = 
                    '<span class="text-warning">⚠ Using demo mode (Firebase loading slow)</span>';
                document.addEventListener('DOMContentLoaded', function() {
                    window.app = new LabourHiringApp();
                });
            }
        }, 10000);
    </script>
    
    <!-- reCAPTCHA Container (hidden) -->
    <div id="recaptcha-container" style="display: none;"></div>
</body>
</html>